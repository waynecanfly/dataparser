# -*- coding:utf-8 -*-
import csv
import re
import sys
import time
import traceback

from algorithm.common.para import Para
from gen_line_table import gen_line_table
from chn_singlecharacter_converge import chn_singlecharacter_converge
from character_converge_exceptions import SourceColumnNumError
from character_to_word import character_to_word
from algorithm.common import tools, configManage
from sort_character import sort_character
from word_to_block import word_to_block


def saveBlockBox(para, blockBox, p_country, p_company, p_reportid):
    save_root = configManage.config['location']['pdf_block'] if para.statusid == 10 else configManage.config['location']['pdf_block_noline']
    savepath_block = save_root + "/p_country={p_country}/p_company={p_company}/"
    savepath_block = savepath_block.format(p_country=p_country, p_company=p_company)
    tools.makeDirs(savepath_block)

    outputData = []
    for b in blockBox:
        outputData.append([b.pageNum,
                           b.text,
                           b.x0,
                           b.y0,
                           b.x1,
                           b.y1,
                           b.direction,
                           b.size,
                           b.font,
                           b.word_gap,
                           b.lineIndex,
                           b.type,
                           b.lineTableId,
                           tools.linkStr(b.talbeLineIndexs, '|') if b.talbeLineIndexs else '',
                           tools.linkStr(b.talbeColumnIndexs, '|') if b.talbeColumnIndexs else ''])

    with file(savepath_block + '/' + p_reportid + '.csv', 'w+') as outputFile:
        writer = csv.writer(outputFile)
        for data in outputData:
            writer.writerow(data)

def process(para, istest=False):
    p_country, p_company, p_reportid = para.countryid, para.companyid, para.reportid
    try:
        characterBox = sort_character.process(p_country, p_company, p_reportid)

        # wordBoxMap = character_to_word.process(characterBox)

        # for w in wordBoxMap[49]:
        #     print w.text + '    ' + str(w.x0)  + '    ' + str(w.x1)  + '    ' + str(w.y0)  + '    ' + str(w.y1)
        # 获取线表
        if para.statusid == 10:
            lineTableBox = gen_line_table.process(p_country, p_company, p_reportid, characterBox)
        else:
            lineTableBox = {}


        # for b in characterBox[48]:
        #     print b.text + '  '  + str(b.orderid) + ' ' + str(b.lineIndex) + ' ' + str(b.y0) + ' ' + str(b.y1)


        blockBox = word_to_block.process(characterBox, lineTableBox, p_country)

        # for b in blockBox:
        #     if b.pageNum == 48:
        #         print b.text + '  ' + str(b.lineTableId) + ' ' + str(b.wordBox[0].orderid) + ' ' + str(b.wordBox[0].lineIndex) + ' ' + str(b.wordBox[0].y0) + ' ' + str(b.wordBox[0].y1)
        # print '======================'

        # 单独字符汇聚处理，中文，韩文，日文 这一类的语言会有这种情况
        blockBox = chn_singlecharacter_converge.process(blockBox) if p_country in 'CHN' else blockBox


        if istest:
            saveBlockBox(para, blockBox, p_country, p_company, p_reportid)
            return True
        else:
            saveBlockBox(para, blockBox, p_country, p_company, p_reportid)
            update_status = 20 if para.statusid == 10 else 40
            tools.updatePDFStatus(p_country, p_company, p_reportid, update_status, '')
            return True
    except Exception as e:
        source_message = traceback.format_exc()
        excepttext = re.sub('\n', ' ', source_message)
        excepttext = re.sub('\"', '\'', excepttext)
        print p_reportid + '\n' + source_message
        if istest:
            return False
        else:
            update_status = -20 if para.statusid == 10 else -40
            tools.updatePDFStatus(p_country, p_company, p_reportid, update_status, excepttext, e.message)


# 例子
if __name__ == '__main__':
    reload(sys)
    sys.setdefaultencoding('utf-8')
    # 初始化配置
    configManage.initConfig(False)


    idlist = ['CHN100032007000601042', 'CHN100032008000201025', 'CHN100032008000201038', 'CHN100032008000601034', 'CHN100032009000601037', 'CHN100032010000201032', 'CHN100032011000201035', 'CHN100042007000601040', 'CHN100042007000601041', 'CHN100042008000201038', 'CHN100042008000601037', 'CHN100042009000201035', 'CHN100042009000601034', 'CHN100062007000601036', 'CHN100062014000601010', 'CHN100102008000601038', 'CHN100162013000601010', 'CHN100162014000601006', 'CHN100172008000201042', 'CHN100182016000601007', 'CHN100192012000201031', 'CHN100222009000201037', 'CHN100222012000101029', 'CHN100252011000201030', 'CHN100252012000201026', 'CHN100252013000601017', 'CHN100252015000601009', 'CHN100272010000601036', 'CHN100272011000601033', 'CHN100272012000201026', 'CHN100272013000201023', 'CHN100272013000601027', 'CHN100272014000601024', 'CHN100272015000601021', 'CHN100272016000601018', 'CHN100272017000601015', 'CHN100282010000201034', 'CHN100282013000601021', 'CHN100282015000201016', 'CHN100292009000201031', 'CHN100322014000601034', 'CHN100352017000601406', 'CHN100362011000201018', 'CHN100362015000601023', 'CHN100362017000201004', 'CHN100372013000601035', 'CHN100392008000201023', 'CHN100392010000601037', 'CHN100392011000201017', 'CHN100412011000601035', 'CHN100432008000601038', 'CHN100442011000201030', 'CHN100472008000201036', 'CHN100472015000601014', 'CHN100482008000601035', 'CHN100492012000101013', 'CHN100502010000301034', 'CHN100502012000101011', 'CHN100522013000201007', 'CHN100542011000601031', 'CHN100542017000201022', 'CHN100552011000601033', 'CHN100552012000601030', 'CHN100562009000601037', 'CHN100562017000301007', 'CHN100592011000601037', 'CHN100592012000601036', 'CHN100592016000601028', 'CHN100602011000601036', 'CHN100602013000101007', 'CHN100602016000601023', 'CHN100602017000201004', 'CHN100602018000201401', 'CHN100632016000101002', 'CHN100662012000601024', 'CHN100662013000101014', 'CHN100662013000201015', 'CHN100662013000601020', 'CHN100662014000101010', 'CHN100662014000301017', 'CHN100662015000101006', 'CHN100662015000201007', 'CHN100662015000301013', 'CHN100662016000101003', 'CHN100662017000301005', 'CHN100722007000601037', 'CHN100722008000201041', 'CHN100722008000301034', 'CHN100722009000101025', 'CHN100722010000301027', 'CHN100722011000101017', 'CHN100722011000301023', 'CHN100722012000101014', 'CHN100722012000301019', 'CHN100722013000201033', 'CHN100722013000601016', 'CHN100722014000101008', 'CHN100722014000201030', 'CHN100722014000301012', 'CHN100722014000601013', 'CHN100722015000601010', 'CHN100722016000101002', 'CHN100722016000201022', 'CHN100722016000601007', 'CHN100722017000201018', 'CHN100722017000601004', 'CHN100742017000601007', 'CHN100742018000101402', 'CHN100882011000601022', 'CHN100892012000101017', 'CHN100902008000201037', 'CHN100902008000601039', 'CHN100902009000201033', 'CHN100962011000601035', 'CHN101022008000201039', 'CHN101022011000201031', 'CHN101022011000601029', 'CHN101102010000201035', 'CHN101102010000601034', 'CHN101152010000201021', 'CHN101202009000601031', 'CHN101252011000601027', 'CHN101272007000601041', 'CHN101292007000601040', 'CHN101292011000201023', 'CHN101302010000601035', 'CHN101302012000601027', 'CHN101302013000601023', 'CHN101302015000601015', 'CHN101302017000601405', 'CHN101302017000601407', 'CHN101392010000601033', 'CHN101422010000201025', 'CHN101522009000601035', 'CHN101522011000101013', 'CHN101522012000201024', 'CHN101532009000601036', 'CHN101552009000101031', 'CHN101552018000201403', 'CHN101622011000601035', 'CHN101622016000201005', 'CHN101642010000201029', 'CHN101652009000601029', 'CHN101672007000601041', 'CHN101672008000201038', 'CHN101672008000601040', 'CHN101672014000301013', 'CHN101692007000601041', 'CHN101692018000101403', 'CHN101692018000201401', 'CHN101742010000201029', 'CHN101752009000201018', 'CHN101762008000101038', 'CHN101782015000301012', 'CHN101792012000301018', 'CHN101802016000301011', 'CHN101802016000601006', 'CHN101812010000601031', 'CHN101812012000601023', 'CHN101812014000201008', 'CHN101892016000201012', 'CHN101902015000201005', 'CHN101902017000301007', 'CHN101912009000601038', 'CHN101942008000601039', 'CHN101962009000201018', 'CHN101962017000601024', 'CHN102002014000601007', 'CHN102012008000101033', 'CHN102012008000201034', 'CHN102012009000201030', 'CHN102012010000201026', 'CHN102012011000201022', 'CHN102032017000301007', 'CHN102092015000301016', 'CHN102102007000601039', 'CHN102102008000601036', 'CHN102102009000601032', 'CHN102102010000201031', 'CHN102102010000601028', 'CHN102102011000201027', 'CHN102102012000601020', 'CHN102102018000201401', 'CHN102122010000201028', 'CHN102122010000601029', 'CHN102122013000201016', 'CHN102122013000601017', 'CHN102122015000201008', 'CHN102162007000601041', 'CHN102162008000601040', 'CHN102172009000601038', 'CHN102202008000201020', 'CHN102202009000201019', 'CHN102202010000201018', 'CHN102202012000101006', 'CHN102212015000301015', 'CHN102222010000301032', 'CHN102222016000301008', 'CHN102292008000201021', 'CHN102292015000301024']
    idlist = ['CHN100032007000601042', 'CHN100032008000201025', 'CHN100032008000201038', 'CHN100032008000601034', 'CHN100032009000601037', 'CHN100032010000201032', 'CHN100032011000201035', 'CHN100042007000601040', 'CHN100042007000601041', 'CHN100042008000201038', 'CHN100042008000601037', 'CHN100042009000201035', 'CHN100042009000601034', 'CHN100062007000601036', 'CHN100062014000601010', 'CHN100102008000601038', 'CHN100162013000601010', 'CHN100162014000601006', 'CHN100172008000201042', 'CHN100182016000601007', 'CHN100192012000201031', 'CHN100222009000201037', 'CHN100222012000101029', 'CHN100252011000201030', 'CHN100252012000201026', 'CHN100252013000601017', 'CHN100252015000601009', 'CHN100272010000601036', 'CHN100272011000601033', 'CHN100272012000201026', 'CHN100272013000201023', 'CHN100272013000601027', 'CHN100272014000601024', 'CHN100272015000601021', 'CHN100272016000601018', 'CHN100272017000601015', 'CHN100282010000201034', 'CHN100282013000601021', 'CHN100282015000201016', 'CHN100292009000201031', 'CHN100322014000601034', 'CHN100352017000601406', 'CHN100362011000201018', 'CHN100362015000601023', 'CHN100362017000201004', 'CHN100372013000601035', 'CHN100392008000201023', 'CHN100392010000601037', 'CHN100392011000201017', 'CHN100412011000601035', 'CHN100432008000601038', 'CHN100442011000201030', 'CHN100472008000201036', 'CHN100472015000601014', 'CHN100482008000601035', 'CHN100492012000101013', 'CHN100502010000301034', 'CHN100502012000101011', 'CHN100522013000201007', 'CHN100542011000601031', 'CHN100542017000201022', 'CHN100552011000601033', 'CHN100552012000601030', 'CHN100562009000601037', 'CHN100562017000301007', 'CHN100592011000601037', 'CHN100592012000601036', 'CHN100592016000601028', 'CHN100602011000601036', 'CHN100602013000101007', 'CHN100602016000601023', 'CHN100602017000201004', 'CHN100602018000201401', 'CHN100632016000101002', 'CHN100662012000601024', 'CHN100662013000101014', 'CHN100662013000201015', 'CHN100662013000601020', 'CHN100662014000101010', 'CHN100662014000301017', 'CHN100662015000101006', 'CHN100662015000201007', 'CHN100662015000301013', 'CHN100662016000101003', 'CHN100662017000301005', 'CHN100722007000601037', 'CHN100722008000201041', 'CHN100722008000301034', 'CHN100722009000101025', 'CHN100722010000301027', 'CHN100722011000101017', 'CHN100722011000301023', 'CHN100722012000101014', 'CHN100722012000301019', 'CHN100722013000201033', 'CHN100722013000601016', 'CHN100722014000101008', 'CHN100722014000201030', 'CHN100722014000301012', 'CHN100722014000601013', 'CHN100722015000601010', 'CHN100722016000101002', 'CHN100722016000201022', 'CHN100722016000601007', 'CHN100722017000201018', 'CHN100722017000601004', 'CHN100742017000601007', 'CHN100742018000101402', 'CHN100882011000601022', 'CHN100892012000101017', 'CHN100902008000201037', 'CHN100902008000601039', 'CHN100902009000201033', 'CHN100962011000601035', 'CHN101022008000201039', 'CHN101022011000201031', 'CHN101022011000601029', 'CHN101102010000201035', 'CHN101102010000601034', 'CHN101152010000201021', 'CHN101202009000601031', 'CHN101252011000601027', 'CHN101272007000601041', 'CHN101292007000601040', 'CHN101292011000201023', 'CHN101302010000601035', 'CHN101302012000601027', 'CHN101302013000601023', 'CHN101302015000601015', 'CHN101302017000601405', 'CHN101302017000601407', 'CHN101392010000601033', 'CHN101422010000201025', 'CHN101522009000601035', 'CHN101522011000101013', 'CHN101522012000201024', 'CHN101532009000601036', 'CHN101552009000101031', 'CHN101552018000201403', 'CHN101622011000601035', 'CHN101622016000201005', 'CHN101642010000201029', 'CHN101652009000601029', 'CHN101672007000601041', 'CHN101672008000201038', 'CHN101672008000601040', 'CHN101672014000301013', 'CHN101692007000601041', 'CHN101692018000101403', 'CHN101692018000201401', 'CHN101742010000201029', 'CHN101752009000201018', 'CHN101762008000101038', 'CHN101782015000301012', 'CHN101792012000301018', 'CHN101802016000301011', 'CHN101802016000601006', 'CHN101812010000601031', 'CHN101812012000601023', 'CHN101812014000201008', 'CHN101892016000201012', 'CHN101902015000201005', 'CHN101902017000301007', 'CHN101912009000601038', 'CHN101942008000601039', 'CHN101962009000201018', 'CHN101962017000601024', 'CHN102002014000601007', 'CHN102012008000101033', 'CHN102012008000201034', 'CHN102012009000201030', 'CHN102012010000201026', 'CHN102012011000201022', 'CHN102032017000301007', 'CHN102092015000301016', 'CHN102102007000601039', 'CHN102102008000601036', 'CHN102102009000601032', 'CHN102102010000201031', 'CHN102102010000601028', 'CHN102102011000201027', 'CHN102102012000601020', 'CHN102102018000201401', 'CHN102122010000201028', 'CHN102122010000601029', 'CHN102122013000201016', 'CHN102122013000601017', 'CHN102122015000201008', 'CHN102162007000601041', 'CHN102162008000601040', 'CHN102172009000601038', 'CHN102202008000201020', 'CHN102202009000201019', 'CHN102202010000201018', 'CHN102202012000101006', 'CHN102212015000301015', 'CHN102222010000301032', 'CHN102222016000301008', 'CHN102292008000201021', 'CHN102292015000301024']
    idlist = ['CHN100032008000201025', 'CHN100032008000201038', 'CHN100032010000201032', 'CHN100032011000201035', 'CHN100172008000201042', 'CHN100272014000601024', 'CHN100272015000601021', 'CHN100272016000601018', 'CHN100272017000601015', 'CHN100292009000201031', 'CHN100362015000601023', 'CHN100362017000201004', 'CHN100412011000601035', 'CHN100432008000601038', 'CHN100442011000201030', 'CHN100482008000601035', 'CHN100542011000601031', 'CHN100542017000201022', 'CHN100552012000601030', 'CHN100562017000301007', 'CHN100592012000601036', 'CHN100592016000601028', 'CHN100602013000101007', 'CHN100602016000601023', 'CHN100602017000201004', 'CHN100602018000201401', 'CHN100892012000101017', 'CHN101022011000201031', 'CHN101102010000201035', 'CHN101102010000601034', 'CHN101522012000201024', 'CHN101652009000601029', 'CHN101672007000601041', 'CHN101752009000201018', 'CHN101892016000201012', 'CHN101902017000301007', 'CHN101962009000201018', 'CHN101962017000601024', 'CHN102012008000101033', 'CHN102102018000201401', 'CHN102122010000601029', 'CHN102172009000601038', 'CHN102212015000301015']

    # 200 ALL
    idlist = ['CHN100032007000601042', 'CHN100032008000201025', 'CHN100032008000201038', 'CHN100032008000601034', 'CHN100032009000601037', 'CHN100032010000201032', 'CHN100032011000201035', 'CHN100042007000601040', 'CHN100042007000601041', 'CHN100042008000201038', 'CHN100042008000601037', 'CHN100042009000201035', 'CHN100042009000601034', 'CHN100062007000601036', 'CHN100062014000601010', 'CHN100102008000601038', 'CHN100162013000601010', 'CHN100162014000601006', 'CHN100172008000201042', 'CHN100182016000601007', 'CHN100192012000201031', 'CHN100222009000201037', 'CHN100222012000101029', 'CHN100252011000201030', 'CHN100252012000201026', 'CHN100252013000601017', 'CHN100252015000601009', 'CHN100272010000601036', 'CHN100272011000601033', 'CHN100272012000201026', 'CHN100272013000201023', 'CHN100272013000601027', 'CHN100272014000601024', 'CHN100272015000601021', 'CHN100272016000601018', 'CHN100272017000601015', 'CHN100282010000201034', 'CHN100282013000601021', 'CHN100282015000201016', 'CHN100292009000201031', 'CHN100322014000601034', 'CHN100352017000601406', 'CHN100362011000201018', 'CHN100362015000601023', 'CHN100362017000201004', 'CHN100372013000601035', 'CHN100392008000201023', 'CHN100392010000601037', 'CHN100392011000201017', 'CHN100412011000601035', 'CHN100432008000601038', 'CHN100442011000201030', 'CHN100472008000201036', 'CHN100472015000601014', 'CHN100482008000601035', 'CHN100492012000101013', 'CHN100502010000301034', 'CHN100502012000101011', 'CHN100522013000201007', 'CHN100542011000601031', 'CHN100542017000201022', 'CHN100552011000601033', 'CHN100552012000601030', 'CHN100562009000601037', 'CHN100562017000301007', 'CHN100592011000601037', 'CHN100592012000601036', 'CHN100592016000601028', 'CHN100602011000601036', 'CHN100602013000101007', 'CHN100602016000601023', 'CHN100602017000201004', 'CHN100602018000201401', 'CHN100632016000101002', 'CHN100662012000601024', 'CHN100662013000101014', 'CHN100662013000201015', 'CHN100662013000601020', 'CHN100662014000101010', 'CHN100662014000301017', 'CHN100662015000101006', 'CHN100662015000201007', 'CHN100662015000301013', 'CHN100662016000101003', 'CHN100662017000301005', 'CHN100722007000601037', 'CHN100722008000201041', 'CHN100722008000301034', 'CHN100722009000101025', 'CHN100722010000301027', 'CHN100722011000101017', 'CHN100722011000301023', 'CHN100722012000101014', 'CHN100722012000301019', 'CHN100722013000201033', 'CHN100722013000601016', 'CHN100722014000101008', 'CHN100722014000201030', 'CHN100722014000301012', 'CHN100722014000601013', 'CHN100722015000601010', 'CHN100722016000101002', 'CHN100722016000201022', 'CHN100722016000601007', 'CHN100722017000201018', 'CHN100722017000601004', 'CHN100742017000601007', 'CHN100742018000101402', 'CHN100882011000601022', 'CHN100892012000101017', 'CHN100902008000201037', 'CHN100902008000601039', 'CHN100902009000201033', 'CHN100962011000601035', 'CHN101022008000201039', 'CHN101022011000201031', 'CHN101022011000601029', 'CHN101102010000201035', 'CHN101102010000601034', 'CHN101152010000201021', 'CHN101202009000601031', 'CHN101252011000601027', 'CHN101272007000601041', 'CHN101292007000601040', 'CHN101292011000201023', 'CHN101302010000601035', 'CHN101302012000601027', 'CHN101302013000601023', 'CHN101302015000601015', 'CHN101302017000601405', 'CHN101302017000601407', 'CHN101392010000601033', 'CHN101422010000201025', 'CHN101522009000601035', 'CHN101522011000101013', 'CHN101522012000201024', 'CHN101532009000601036', 'CHN101552009000101031', 'CHN101552018000201403', 'CHN101622011000601035', 'CHN101622016000201005', 'CHN101642010000201029', 'CHN101652009000601029', 'CHN101672007000601041', 'CHN101672008000201038', 'CHN101672008000601040', 'CHN101672014000301013', 'CHN101692007000601041', 'CHN101692018000101403', 'CHN101692018000201401', 'CHN101742010000201029', 'CHN101752009000201018', 'CHN101762008000101038', 'CHN101782015000301012', 'CHN101792012000301018', 'CHN101802016000301011', 'CHN101802016000601006', 'CHN101812010000601031', 'CHN101812012000601023', 'CHN101812014000201008', 'CHN101892016000201012', 'CHN101902015000201005', 'CHN101902017000301007', 'CHN101912009000601038', 'CHN101942008000601039', 'CHN101962009000201018', 'CHN101962017000601024', 'CHN102002014000601007', 'CHN102012008000101033', 'CHN102012008000201034', 'CHN102012009000201030', 'CHN102012010000201026', 'CHN102012011000201022', 'CHN102032017000301007', 'CHN102092015000301016', 'CHN102102007000601039', 'CHN102102008000601036', 'CHN102102009000601032', 'CHN102102010000201031', 'CHN102102010000601028', 'CHN102102011000201027', 'CHN102102012000601020', 'CHN102102018000201401', 'CHN102122010000201028', 'CHN102122010000601029', 'CHN102122013000201016', 'CHN102122013000601017', 'CHN102122015000201008', 'CHN102162007000601041', 'CHN102162008000601040', 'CHN102172009000601038', 'CHN102202008000201020', 'CHN102202009000201019', 'CHN102202010000201018', 'CHN102202012000101006', 'CHN102212015000301015', 'CHN102222010000301032', 'CHN102222016000301008', 'CHN102292008000201021', 'CHN102292015000301024']

    idlist = ['CHN100032007000601042', 'CHN100032008000201025', 'CHN100032008000201038', 'CHN100032008000601034', 'CHN100032009000601037', 'CHN100032010000201032', 'CHN100032011000201035', 'CHN100042007000601040', 'CHN100042007000601041', 'CHN100042008000201038', 'CHN100042008000601037', 'CHN100042009000201035', 'CHN100042009000601034', 'CHN100062007000601036', 'CHN100062014000601010', 'CHN100102008000601038', 'CHN100162013000601010', 'CHN100162014000601006', 'CHN100172008000201042', 'CHN100182016000601007', 'CHN100192012000201031', 'CHN100222009000201037', 'CHN100222012000101029', 'CHN100252011000201030', 'CHN100252012000201026', 'CHN100252013000601017', 'CHN100252015000601009', 'CHN100272010000601036', 'CHN100272011000601033', 'CHN100272012000201026']
    # idlist = ['CHN100272013000201023', 'CHN100272013000601027', 'CHN100272014000601024', 'CHN100272015000601021', 'CHN100272016000601018', 'CHN100272017000601015', 'CHN100282010000201034', 'CHN100282013000601021', 'CHN100282015000201016', 'CHN100292009000201031', 'CHN100322014000601034', 'CHN100352017000601406', 'CHN100362011000201018', 'CHN100362015000601023', 'CHN100362017000201004', 'CHN100372013000601035', 'CHN100392008000201023', 'CHN100392010000601037', 'CHN100392011000201017', 'CHN100412011000601035', 'CHN100432008000601038', 'CHN100442011000201030', 'CHN100472008000201036', 'CHN100472015000601014', 'CHN100482008000601035', 'CHN100492012000101013', 'CHN100502010000301034', 'CHN100502012000101011', 'CHN100522013000201007', 'CHN100542011000601031']
    # idlist = ['CHN100542017000201022', 'CHN100552011000601033', 'CHN100552012000601030', 'CHN100562009000601037', 'CHN100562017000301007', 'CHN100592011000601037', 'CHN100592012000601036', 'CHN100592016000601028', 'CHN100602011000601036', 'CHN100602013000101007', 'CHN100602016000601023', 'CHN100602017000201004', 'CHN100602018000201401', 'CHN100632016000101002', 'CHN100662012000601024', 'CHN100662013000101014', 'CHN100662013000201015', 'CHN100662013000601020', 'CHN100662014000101010', 'CHN100662014000301017', 'CHN100662015000101006', 'CHN100662015000201007', 'CHN100662015000301013', 'CHN100662016000101003', 'CHN100662017000301005', 'CHN100722007000601037', 'CHN100722008000201041', 'CHN100722008000301034', 'CHN100722009000101025', 'CHN100722010000301027']
    # idlist = ['CHN100722011000101017', 'CHN100722011000301023', 'CHN100722012000101014', 'CHN100722012000301019', 'CHN100722013000201033', 'CHN100722013000601016', 'CHN100722014000101008', 'CHN100722014000201030', 'CHN100722014000301012', 'CHN100722014000601013', 'CHN100722015000601010', 'CHN100722016000101002', 'CHN100722016000201022', 'CHN100722016000601007', 'CHN100722017000201018', 'CHN100722017000601004', 'CHN100742017000601007', 'CHN100742018000101402', 'CHN100882011000601022', 'CHN100892012000101017', 'CHN100902008000201037', 'CHN100902008000601039', 'CHN100902009000201033', 'CHN100962011000601035', 'CHN101022008000201039', 'CHN101022011000201031', 'CHN101022011000601029', 'CHN101102010000201035', 'CHN101102010000601034', 'CHN101152010000201021']
    # idlist = ['CHN101202009000601031', 'CHN101252011000601027', 'CHN101272007000601041', 'CHN101292007000601040', 'CHN101292011000201023', 'CHN101302010000601035', 'CHN101302012000601027', 'CHN101302013000601023', 'CHN101302015000601015', 'CHN101302017000601405', 'CHN101302017000601407', 'CHN101392010000601033', 'CHN101422010000201025', 'CHN101522009000601035', 'CHN101522011000101013', 'CHN101522012000201024', 'CHN101532009000601036', 'CHN101552009000101031', 'CHN101552018000201403', 'CHN101622011000601035', 'CHN101622016000201005', 'CHN101642010000201029', 'CHN101652009000601029', 'CHN101672007000601041', 'CHN101672008000201038', 'CHN101672008000601040', 'CHN101672014000301013', 'CHN101692007000601041', 'CHN101692018000101403', 'CHN101692018000201401']
    # idlist = ['CHN101742010000201029', 'CHN101752009000201018', 'CHN101762008000101038', 'CHN101782015000301012', 'CHN101792012000301018', 'CHN101802016000301011', 'CHN101802016000601006', 'CHN101812010000601031', 'CHN101812012000601023', 'CHN101812014000201008', 'CHN101892016000201012', 'CHN101902015000201005', 'CHN101902017000301007', 'CHN101912009000601038', 'CHN101942008000601039', 'CHN101962009000201018', 'CHN101962017000601024', 'CHN102002014000601007', 'CHN102012008000101033', 'CHN102012008000201034']
    # idlist = ['CHN102012009000201030', 'CHN102012010000201026', 'CHN102012011000201022', 'CHN102032017000301007', 'CHN102092015000301016', 'CHN102102007000601039', 'CHN102102008000601036', 'CHN102102009000601032', 'CHN102102010000201031', 'CHN102102010000601028']
    # idlist = ['CHN102102011000201027', 'CHN102102012000601020', 'CHN102102018000201401', 'CHN102122010000201028', 'CHN102122010000601029', 'CHN102122013000201016', 'CHN102122013000601017', 'CHN102122015000201008', 'CHN102162007000601041', 'CHN102162008000601040', 'CHN102172009000601038', 'CHN102202008000201020', 'CHN102202009000201019', 'CHN102202010000201018', 'CHN102202012000101006', 'CHN102212015000301015', 'CHN102222010000301032', 'CHN102222016000301008', 'CHN102292008000201021', 'CHN102292015000301024']
    idlist = ['CHN107422016000601016']
    idlist = ['CHN1337301797751']
    idlist = ['CHN101942008000601039']

    for l in idlist:
        reportid = l
        print reportid
        countryid = reportid[0:3]
        companyid = reportid[0:8]
        para = Para(countryid, companyid, reportid, 10, '2', '3', '4', '5', '6', '7', 'x', '8', '9')

        begin = time.time()
        print process(para, False)
        end = time.time()-begin
        print end