# -*- coding: UTF-8 -*-
import datetime
import re
import sys
import traceback

import pandas as pd

from algorithm.common import configManage, tools, dbtools
from algorithm.common.para import Para
from algorithm.financial_statement_pdf import fs_pdf_tools
from algorithm.financial_statement_pdf.fs_push_tools import update_aft_push, get_company_leader, delete_bf_push, \
    get_disclosure_date_result, get_doc_local_path, get_doc_source_url, get_fs_id_result, special_handling_subject, \
    special_handling_value

column_names = ['country', 'company_id', 'report_id', 'company_name', 'table_type', 'page_num', 'fiscal_year',
                'season_type', 'subject_text', 'value', 'value_currency', 'value_measureunit', 'time_begin',
                'time_end', 'line_index', 'columne_index', 'is_consolidated']

season_type2range = {'Q1': '3',
                     'Q2': '6',
                     'Q3': '9',
                     'FY': '12',
                     'HY': '6'}

class PushException(Exception):
    def __init__(self, message):
        Exception.__init__(self, message)
        self.message = message

def push(report,country,company):
    read_path = configManage.config['location'][
                    'pdf_table_new'] + "/p_country={p_country}/p_company={p_company}/{report}.csv"
    read_path = read_path.format(p_country=country, p_company=company, report=report)
    push_dateframe = pd.read_csv(read_path, names=column_names, index_col=False)
    push_dateframe.fillna('', inplace=True)
    table_types = set(push_dateframe.table_type)


    for table_type in table_types:
        # 披露日期
        disclosure_date_result = get_disclosure_date_result(report)
        # doc_local_path
        doc_local_path = get_doc_local_path(report)
        # doc_source_url
        doc_source_url = get_doc_source_url(report)
        table = push_dateframe[push_dateframe.table_type == table_type]
        report = push_dateframe.report_id[0]
        guid = report + table_type
        time_begin = max(table['time_begin'])
        time_end = max(table['time_end'])
        if time_end.endswith('02-31'):
            time_end = re.sub('31', '28', time_end)

        company_name = table['company_name'].iloc[0]
        fiscal_year = table['fiscal_year'].iloc[0]
        season_type = table['season_type'].iloc[0]
        value_currency = table['value_currency'].iloc[0]
        value_measureunit = table['value_measureunit'].iloc[0]
        is_locked = 0
        now_time = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        gmt_create = now_time
        user_create = 'cf'
        month_range = season_type2range[season_type]
        person = get_company_leader(guid)
        # 标记已完成的不推
        checkifdone_sql = "SELECT is_check_done from g_fs_data_original where guid='{}'".format(guid)
        result = dbtools.query_opd_fdss_test(checkifdone_sql)
        if result:
            is_check_done = result[0][0]
            if is_check_done == 'Y':
                continue
            elif is_check_done == 'N':
                # 推数据前执行删除
                # delete_bf_push(guid)
                configManage.logger.info(guid + 'deleted')

        if table_type != 'BS':
            original_sql = """INSERT into g_fs_data_original (guid, country_code, company_name, company_code, disclosure_date,fiscal_year, start_date, end_date, month_range, fs_type_code, fs_season_type_code, doc_source_path, doc_source_url, currency_code, measure_unit_code,is_locked,assigned_to,gmt_create,user_create)
            VALUES('{guid}','{country_code}','{company_name}','{company_code}','{disclosure_date}','{fiscal_year}','{start_date}','{end_date}','{month_range}','{fs_type_code}','{fs_season_type}','{doc_source_path}','{doc_source_url}','{currency_code}','{measure_unit_code}','{is_locked}','{assigned_to}','{gmt_create}','{user_create}')"""
            original_sql = original_sql.format(guid=guid, country_code='CHN', company_name=company_name,
                                       company_code=company,
                                       disclosure_date=disclosure_date_result, fiscal_year=fiscal_year,
                                       start_date=time_begin,
                                       end_date=time_end,
                                       month_range=month_range, fs_type_code=table_type,
                                       doc_source_path=doc_local_path, doc_source_url=doc_source_url,
                                       fs_season_type=season_type,
                                       currency_code=value_currency, measure_unit_code=value_measureunit,
                                       is_locked=is_locked,
                                       gmt_create=gmt_create, user_create=user_create, assigned_to=person)

        else:
            original_sql = """INSERT into g_fs_data_original (guid, country_code, company_name, company_code, disclosure_date,fiscal_year, end_date, month_range, fs_type_code, fs_season_type_code,doc_source_path, doc_source_url, currency_code, measure_unit_code,is_locked,assigned_to,gmt_create,user_create)
                            VALUES('{guid}','{country_code}','{company_name}','{company_code}','{disclosure_date}','{fiscal_year}','{end_date}','{month_range}','{fs_type_code}','{fs_season_type}','{doc_source_path}','{doc_source_url}','{currency_code}','{measure_unit_code}','{is_locked}','{assigned_to}','{gmt_create}','{user_create}')"""
            original_sql = original_sql.format(guid=guid, country_code='CHN', company_name=company_name,
                                       company_code=company,
                                       disclosure_date=disclosure_date_result, fiscal_year=fiscal_year,
                                       end_date=time_end,
                                       month_range=month_range, fs_type_code=table_type,
                                       doc_source_path=doc_local_path, doc_source_url=doc_source_url,
                                       fs_season_type=season_type,
                                       currency_code=value_currency, measure_unit_code=value_measureunit,
                                       is_locked=is_locked,
                                       gmt_create=gmt_create, user_create=user_create, assigned_to=person)

        dbtools.query_opd_fdss_test(original_sql)
        fs_id_result = get_fs_id_result(guid)

        detail_sql = """INSERT into g_fs_data_original_detail (fs_original_id, fs_original_guid, country_code, company_code, company_name, fiscal_year, fs_type_code, fs_season_type_code, item_name, item_label, item_value, unit_of_measurement, end_date, date_range) VALUES"""
        for i, row in table.iterrows():
            item_label = row['subject_text']
            subject_text = special_handling_subject(item_label)
            value = row['value']
            item_value = special_handling_value(value)
            time_begin = row['time_begin']
            time_end = row['time_end']
            if time_begin not in ('', 'None'):
                data_range = time_begin + '_' + time_end
            else:
                data_range = time_end
            values_sql = """('{fs_original_id}','{fs_original_guid}','{country_code}','{company_code}','{company_name}','{fiscal_year}','{fs_type_code}','{fs_season_type_code}','{item_name}','{item_label}','{item_value}','{unit_of_measurement}','{end_date}','{data_range}'),"""
            values_sql = values_sql.format(fs_original_id=fs_id_result, fs_original_guid=guid, country_code='CHN',
                                           company_code=company, company_name=company_name, fiscal_year=fiscal_year,
                                           fs_type_code=table_type, fs_season_type_code=season_type,
                                           item_name=subject_text, item_label=item_label, item_value=item_value,
                                           unit_of_measurement=value_measureunit, end_date=time_end,
                                           data_range=data_range)
            detail_sql += values_sql
        detail_sql = detail_sql[:-1]  # 去掉最后一个逗号
        print detail_sql
        dbtools.query_opd_fdss_test(detail_sql)







def process(para):
    report = para.reportid
    country = para.countryid
    company = para.companyid
    configManage.logger.info('PUSH BEGIN ' + report + ' : ' + datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S'))

    try:
        # 推送
        push(report,country,company)
        print report + 'pushed'
        # 更新状态
        tools.updatePDFStatus(country, company, report, 110, '')
        print report + 'updated'
    except PushException as e:
        excepttext = e.message
        tools.updatePDFStatus(country, company, report, -110, excepttext)
    except Exception as e:
        excepttext = traceback.format_exc()
        print excepttext
        print report + 'loss'
        # 更新状态
        tools.updatePDFStatus(country, company, report, -110, '')
    configManage.logger.info('PUSH END ' + report + ' : ' + datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S'))

if __name__ == '__main__':
    reload(sys)
    sys.setdefaultencoding('utf-8')

    # 初始化配置
    configManage.initConfig(False)

    idlist = [
        'CHN125342011000201010','CHN125402011000201011','CHN126572011000301010','CHN125682011000301009','CHN126572011000101009','CHN126152011000301013','CHN125832011000201011','CHN125912011000201013','CHN126312011000201012','CHN126312011000101009','CHN126452011000201010','CHN125452011000201010','CHN125952011000101013','CHN125542011000101013','CHN126442011000301011','CHN126452011000601014','CHN125752011000601012','CHN125752011000201008','CHN125532011000201010','CHN126562011000301009','CHN125912011000601018','CHN126452011000101009','CHN126162011000201015','CHN126512011000301009','CHN125622011000101008','CHN126082011000601020','CHN126442011000101009','CHN126512011000101008','CHN126372011000201010','CHN125842011000201009','CHN125522011000301009','CHN125912011000301011','CHN126142011000201012','CHN126442011000601014','CHN126572011000601014','CHN126472011000301010','CHN125422011000301010','CHN125352011000201012','CHN125912011000101010','CHN125802011000601013','CHN125412011000601014','CHN126402011000201015','CHN125632011000201016','CHN125842011000301010','CHN126472011000101009','CHN125592011000601015','CHN125452011000301012','CHN126142011000301013','CHN125952011000201012','CHN125412011000201010','CHN126462011000301012','CHN126462011000201011','CHN126072011000601019','CHN125802011000301010','CHN126572011000201011','CHN125802011000201009','CHN126142011000101011','CHN125422011000201009','CHN126152011000101012','CHN126312011000301010','CHN126312011000601013','CHN125752011000101007','CHN125452011000101009','CHN125402011000601015','CHN125682011000201008','CHN125402011000101008','CHN126292011000301012','CHN125412011000101009','CHN126612011000301017','CHN126132011000601018','CHN126292011000101009','CHN126442011000201010','CHN125452011000601015','CHN126152011000201014','CHN125952011000601015','CHN125732011000201009','CHN125842011000601013','CHN125592011000101010','CHN126562011000201008','CHN125802017000101022','CHN126312017000201026','CHN125842017000301024','CHN125412017000101024','CHN126512017000301022','CHN126452017000301028','CHN126572017000101025','CHN126442017000301027','CHN125592017000201024','CHN125682017000301022','CHN125412017000301026','CHN125402017000201027','CHN125522017000301027','CHN125752017000101022','CHN125472017000101030','CHN125522017000101026','CHN126312017000301028','CHN125692017000201020','CHN125802017000201026','CHN126002017000201028','CHN125842017000201025','CHN126442017000201026','CHN125912017000301034','CHN126452017000201027','CHN126152017000101031','CHN126152017000201032','CHN125912017000201033','CHN126142017000201037','CHN125622017000201022','CHN125402017000301028','CHN125432017000101026','CHN125622017000301023','CHN126572017000201024','CHN126102009000201005','CHN125922009000101004','CHN126442009000201004','CHN125402009000601010','CHN126452009000101003','CHN126152009000101004','CHN125922009000601010','CHN126472009000301004','CHN126472009000101003','CHN125842009000201004','CHN126342009000601008','CHN125412009000201004','CHN126142009000301006','CHN125602009000601012','CHN125702009000101003','CHN126312009000301005','CHN125412009000101003','CHN125912009000601012','CHN126442009000601008','CHN125402009000301005','CHN125452009000301005','CHN125682009000301004','CHN125362009000601012','CHN125842009000601008','CHN126452009000301005','CHN125952009000601010','CHN125362009000201005','CHN125402009000101003','CHN125412009000301005','CHN126442009000301005','CHN125952009000301006','CHN125622009000601007','CHN126142009000201005','CHN126142009000601010','CHN125412009000601008','CHN126392009000301005','CHN125802009000101003','CHN125592009000601009','CHN125522009000601007','CHN126422009000301007','CHN126252009000601011','CHN125752009000301004','CHN126222009000601011','CHN125912009000201005','CHN126512009000201004','CHN125582009000601011','CHN125522009000201004','CHN125452009000201004','CHN125422009000101003','CHN125752009000201003','CHN125422009000201005','CHN125622009000301004','CHN125662009000601009','CHN126602009000601008','CHN126402009000601016','CHN126452009000201004','CHN125912009000301006','CHN126442009000101003','CHN125622009000101003','CHN125422009000601008','CHN125952009000201005','CHN126472009000201005','CHN126472009000601008','CHN125802009000201004','CHN125402009000201004','CHN126452009000601008','CHN126142009000101004','CHN125592009000101004','CHN126462009000601010','CHN125522009000301003','CHN126572009000101004','CHN125802009000601008','CHN126312009000201004','CHN125752010000601010','CHN125632010000601017','CHN125682010000201007','CHN125642010000601011','CHN126152010000301011','CHN126472010000101006','CHN125422010000201006','CHN125522010000301006','CHN125842010000201007','CHN125952010000301009','CHN126312010000301008','CHN126102010000201008','CHN125422010000301007','CHN125412010000201007','CHN126562010000301006','CHN126142010000201008','CHN125912010000101008','CHN125592010000301008','CHN125592010000201007','CHN126602010000201003','CHN126452010000301007','CHN125842010000601011','CHN125952010000601011','CHN126452010000601011','CHN125952010000101008','CHN126442010000601013','CHN125412010000601011','CHN126512010000601010','CHN126472010000301007','CHN126152010000101009','CHN125772010000301012','CHN125402010000201007','CHN125852010000601012','CHN125452010000101007','CHN125922010000201009','CHN125802010000101006','CHN125452010000301008','CHN125842010000101006','CHN125572010000601013','CHN126572010000201008','CHN125752010000201006','CHN125922010000601013','CHN126442010000101007','CHN125622010000601009','CHN125912010000301009','CHN126602010000301002','CHN125522010000201008','CHN126152010000601015','CHN126512010000301007','CHN126452010000101006','CHN125622010000101005','CHN125332010000301009','CHN125402010000301006','CHN125682010000101006','CHN125682010000601010','CHN126152010000201010','CHN126512010000201006','CHN126312010000201007','CHN125982010000601012','CHN125802010000301007','CHN126562010000201007','CHN126572010000101006','CHN126142010000301009','CHN126382014000301019','CHN125912014000101021','CHN126172014000201021','CHN125682014000601018','CHN125522014000101016','CHN125842014000601021','CHN126342014000201017','CHN126152014000201022','CHN125402014000101018','CHN126192014000301022','CHN125802014000601020','CHN125682014000201015','CHN126452014000101020','CHN126512014000201015','CHN126442014000201018','CHN126502014000301018','CHN126512014000301016','CHN126512014000601019','CHN125572014000101018','CHN125562014000301020','CHN125732014000301017','CHN126312014000301019','CHN126442014000101017','CHN125842014000301017','CHN125452014000301020','CHN125372014000101015','CHN125752014000101015','CHN126472014000101017','CHN125402014000201019','CHN126152014000601027','CHN125502014000301017','CHN125952014000201021','CHN126442014000601021','CHN125592014000201018','CHN125892014000601022','CHN126572014000601022','CHN126152014000301023','CHN125842014000201018','CHN126572014000201019','CHN126362014000201018','CHN126242014000101017','CHN125382014000101018','CHN126142014000101021','CHN125422014000201017','CHN126142014000201025','CHN125412014000301018','CHN125602014000201020','CHN125622014000601017','CHN125412014000201019','CHN125402014000301020','CHN125342014000101017','CHN125952014000101020','CHN125402014000601022','CHN125422014000301018','CHN125802014000201017','CHN125842014000101016','CHN125592014000301019','CHN125912014000201024','CHN125902014000301015','CHN125952014000601024','CHN126082014000101024','CHN125802014000101016','CHN125452014000201019','CHN126402014000301024','CHN125752014000301016','CHN126202014000101017','CHN125332014000201019','CHN125622014000201016','CHN126442014000301019','CHN126392014000601023','CHN126122014000201025','CHN125432014000201020','CHN126582014000601010','CHN125412014000601022','CHN126452014000301019','CHN125592014000101017','CHN125332014000101018','CHN126412014000201020','CHN126382014000101018','CHN126452014000601024','CHN125662014000301017','CHN125452014000601023','CHN125802014000301018','CHN126452014000201018','CHN125382014000201023','CHN125552014000101020','CHN125622014000101015','CHN125952013000301018','CHN125452013000301017','CHN125382013000301017','CHN125912013000101017','CHN126172013000601022','CHN125452013000101016','CHN125402013000601021','CHN125832013000601020','CHN125752013000101013','CHN125682013000601016','CHN126352013000301018','CHN126002013000301017','CHN125412013000101015','CHN126442013000101015','CHN126572013000201015','CHN125912013000601026','CHN125402013000101016','CHN125342013000301015','CHN125572013000201017','CHN125342013000101014','CHN125522013000201015','CHN125792013000201015','CHN125842013000101015','CHN125422013000201015','CHN125432013000601019','CHN126472013000301016','CHN126082013000601026','CHN126452013000301017','CHN126142013000201020','CHN126122013000301022','CHN125802013000101014','CHN126392013000101015','CHN126452013000101015','CHN126572013000601018','CHN126152013000101018','CHN126462013000101016','CHN126392013000301016','CHN126372013000201016','CHN125842013000201014','CHN126512013000201013','CHN126172013000301020','CHN126512013000301014','CHN125932013000201020','CHN125572013000101016','CHN126312013000201014','CHN126452013000601021','CHN126312013000301015','CHN125752013000301014','CHN126582013000201008','CHN125952013000101017','CHN126472013000601018','CHN126572013000301016','CHN126512013000101012','CHN125912013000301019','CHN126152013000601024','CHN126552013000601017','CHN125522013000301013','CHN125922013000601024','CHN126152013000301020','CHN126152013000201019','CHN126022013000101023','CHN125862013000301014','CHN126142013000301019','CHN125522013000601021','CHN125952013000601023','CHN126362013000201014','CHN125412013000301016','CHN125452013000601021','CHN125432013000301017','CHN125602013000601022','CHN126472013000101014','CHN126442013000201016','CHN125622013000101012','CHN126412013000201016','CHN126512012000201011','CHN125952012000601019','CHN125622012000201013','CHN125382012000601019','CHN125752012000101009','CHN125912012000101016','CHN126152012000601021','CHN125802012000201011','CHN126012012000601027','CHN125592012000101011','CHN126472012000601015','CHN126452012000301012','CHN125922012000101014','CHN126472012000301013','CHN125432012000601016','CHN125842012000201012','CHN125802012000601015','CHN125592012000201014','CHN126312012000101011','CHN125622012000101010','CHN125682012000601014','CHN125522012000301012','CHN125422012000101011','CHN125522012000101010','CHN125912012000601023','CHN125402012000101012','CHN125412012000101012','CHN125432012000301013','CHN125342012000601016','CHN125832012000601017','CHN125552012000201017','CHN126572012000201012','CHN125452012000201013','CHN126092012000601023','CHN126112012000601023','CHN125682012000301011','CHN125522012000201011','CHN126002012000301014','CHN126472012000101011','CHN125402012000601017','CHN125402012000301013','CHN125572012000601020','CHN126002012000601018','CHN126142012000101014','CHN125912012000201014','CHN125412012000301013','CHN126152012000201016','CHN125452012000101011','CHN126342012000601014','CHN125952012000101016','CHN126312012000601017','CHN126392012000301013','CHN126442012000301012','CHN125952012000301014','CHN126452012000201013','CHN126312012000201016','CHN125802012000301012','CHN125922012000201016','CHN125412012000601017','CHN126172012000601018','CHN125622012000601014','CHN125522012000601017','CHN126142012000301016','CHN126142012000201015','CHN125912012000301015','CHN125402012000201014','CHN126152012000301017','CHN126122012000601023','CHN125452012000601018','CHN125572012000101015','CHN125592012000301013','CHN125622012000301011','CHN125622008000601006','CHN125732008000601006','CHN125802008000201001','CHN125592008000601005','CHN125922008000601007','CHN126162008000201005','CHN125452008000201002','CHN125842008000301002','CHN126452008000301002','CHN125842008000201001','CHN125342008000601006','CHN125752008000601005','CHN126572008000201001','CHN125422008000301002','CHN126572008000601007','CHN126122008000301002','CHN125982008000201001','CHN126512008000601005','CHN125912008000601007','CHN126142008000601007','CHN126152008000601008','CHN126312008000601006','CHN125672008000601004','CHN125532008000301002','CHN125952008000301001','CHN125802008000601005','CHN125702008000601005','CHN125842008000601005','CHN125412008000601006','CHN126142008000301002','CHN126442008000601006','CHN126172008000601010','CHN126472008000301002','CHN126182008000601005','CHN125682008000201003','CHN125912008000301001','CHN126422008000201005','CHN125682008000301002','CHN125802008000301002','CHN126462008000601005','CHN125452008000601006','CHN125332008000201003','CHN126042008000201001','CHN126352008000601008','CHN125952008000601007','CHN125362008000601007','CHN125532008000601006','CHN125752008000301002','CHN125682008000601005','CHN125652008000601004','CHN125522008000301005','CHN125602008000601009','CHN125592008000201001','CHN126452008000201001','CHN125532008000201001','CHN125402008000201001','CHN125422008000601004','CHN126342008000601005','CHN126312008000201003','CHN125582008000301001','CHN126482008000301002','CHN126442015000601025','CHN126502015000101020','CHN125382015000301020','CHN125842015000101019','CHN125802015000301021','CHN126312015000201022','CHN126442015000201022','CHN125432015000601022','CHN125922015000101023','CHN125592015000201021','CHN125452015000601026','CHN125452015000201022','CHN125412015000101020','CHN125622015000201019','CHN125432015000101018','CHN126202015000201021','CHN126312015000601025','CHN126312015000301021','CHN125522015000301022','CHN126002015000201022','CHN125682015000201017','CHN125952015000101022','CHN125382015000201021','CHN126152015000601030','CHN126512015000201017','CHN126452015000301022','CHN125752015000101017','CHN125592015000601025','CHN126152015000101025','CHN125952015000301026','CHN125682015000601020','CHN126412015000101021','CHN126452015000601026','CHN126342015000601022','CHN125842015000301020','CHN125402015000301023','CHN125952015000601033','CHN125412015000201021','CHN126472015000601027','CHN126382015000201023','CHN125802015000201019','CHN126572015000101020','CHN126152015000301026','CHN125752015000201018','CHN125912015000101025','CHN125912015000301028','CHN125842015000601023','CHN125412015000601023','CHN126442015000101020','CHN125752015000601021','CHN125522015000101019','CHN126312015000101020','CHN126512015000601021','CHN125622015000101018','CHN125802015000601025','CHN125522015000601025','CHN126512015000301018','CHN125912015000601032','CHN125592015000301022','CHN125952015000201025','CHN125912015000201027','CHN125472016000101027','CHN126412016000301022','CHN125622016000601024','CHN126002016000601029','CHN126442016000301024','CHN125452016000101024','CHN126382016000201027','CHN126412016000601032','CHN125592016000101020','CHN126152016000301029','CHN126572016000101021','CHN125682016000601021','CHN126452016000601029','CHN125752016000101019','CHN126512016000301020','CHN125752016000301020','CHN125472016000201026','CHN125622016000101021','CHN126202016000101024','CHN125912016000201030','CHN125592016000301023','CHN126312016000201024','CHN125912016000101029','CHN125522016000101023','CHN125402016000301026','CHN126312016000101023','CHN126342016000601025','CHN126442016000601028','CHN126152016000101028','CHN126312016000601027','CHN125402016000601029','CHN125692016000201018','CHN125802016000101024','CHN126512016000601023','CHN125402016000201025','CHN125912016000601035','CHN125842016000601026','CHN126202016000201023','CHN125952016000301032','CHN125692016000301019','CHN125522016000201024','CHN126342016000201023','CHN125622016000201020','CHN125842016000201022','CHN125952016000101029','CHN125472016000301025','CHN125432016000101023','CHN125402016000101024','CHN125952016000301034','CHN125522016000601028','CHN125422016000601026','CHN126382016000101026','CHN125592016000601026','CHN126572016000201023','CHN126442016000101023','CHN125952016000201028','CHN125412016000101027','CHN125682016000201019','CHN125952016000601030','CHN125412016000201025','CHN126152016000601033','CHN125552016000101025','CHN125912016000301031','CHN125932007000601005','CHN126142007000601003','CHN126302007000601005','CHN126402007000601005','CHN126512007000601003','CHN125772007000601006','CHN125832007000601003','CHN125392007000601004','CHN125362007000601002','CHN125842007000601003','CHN126052007000601008','CHN125872007000601002','CHN125512007000601003','CHN125962007000601006','CHN125452007000601003','CHN126572007000601002','CHN125402007000601002','CHN125732007000601005','CHN126152007000601006','CHN125982007000601003','CHN126042007000601005','CHN126312007000601002','CHN125622007000601002','CHN125912007000601004','CHN125682013000301013','CHN125662013000301016','CHN126312014000201018','CHN125682013000101012','CHN125592013000101016'
    ]
    idlist = ['CHN125342011000201010', 'CHN125402011000201011', 'CHN126572011000301010', 'CHN125682011000301009', 'CHN126572011000101009', 'CHN126152011000301013', 'CHN125912011000201013', 'CHN126312011000201012', 'CHN126312011000101009', 'CHN126452011000201010', 'CHN125452011000201010', 'CHN125952011000101013', 'CHN126442011000301011', 'CHN126452011000601014', 'CHN125752011000601012', 'CHN125752011000201008', 'CHN125532011000201010', 'CHN126562011000301009', 'CHN125912011000601018', 'CHN126512011000301009', 'CHN125622011000101008', 'CHN126442011000101009', 'CHN126512011000101008', 'CHN126372011000201010', 'CHN125842011000201009', 'CHN125522011000301009', 'CHN125912011000301011', 'CHN126142011000201012', 'CHN126442011000601014', 'CHN126572011000601014', 'CHN125912011000101010', 'CHN125802011000601013', 'CHN125412011000601014', 'CHN125842011000301010', 'CHN125592011000601015', 'CHN125452011000301012', 'CHN126142011000301013', 'CHN125952011000201012', 'CHN125412011000201010', 'CHN126462011000301012', 'CHN125802011000301010', 'CHN126572011000201011', 'CHN125802011000201009', 'CHN126142011000101011', 'CHN126152011000101012', 'CHN126312011000301010', 'CHN126312011000601013', 'CHN125752011000101007', 'CHN125402011000601015', 'CHN125682011000201008', 'CHN125402011000101008', 'CHN125412011000101009', 'CHN126292011000101009', 'CHN126442011000201010', 'CHN126152011000201014', 'CHN125952011000601015', 'CHN125842011000601013', 'CHN125592011000101010', 'CHN126562011000201008', 'CHN125802017000101022', 'CHN126312017000201026', 'CHN125842017000301024', 'CHN125412017000101024', 'CHN126512017000301022', 'CHN126572017000101025', 'CHN126442017000301027', 'CHN125592017000201024', 'CHN125682017000301022', 'CHN125412017000301026', 'CHN125402017000201027', 'CHN125522017000301027', 'CHN125752017000101022', 'CHN125522017000101026', 'CHN126312017000301028', 'CHN125692017000201020', 'CHN125802017000201026', 'CHN125842017000201025', 'CHN126442017000201026', 'CHN125912017000301034', 'CHN126152017000101031', 'CHN126152017000201032', 'CHN125912017000201033', 'CHN126142017000201037', 'CHN125622017000201022', 'CHN125402017000301028', 'CHN126572017000201024', 'CHN126102009000201005', 'CHN125922009000101004', 'CHN126442009000201004', 'CHN126152009000101004', 'CHN125922009000601010', 'CHN126472009000101003', 'CHN125842009000201004', 'CHN126342009000601008', 'CHN125412009000201004', 'CHN126142009000301006', 'CHN125602009000601012', 'CHN125702009000101003', 'CHN126312009000301005', 'CHN125412009000101003', 'CHN125912009000601012', 'CHN126442009000601008', 'CHN125402009000301005', 'CHN125682009000301004', 'CHN125842009000601008', 'CHN125952009000601010', 'CHN125402009000101003', 'CHN125412009000301005', 'CHN126442009000301005', 'CHN125952009000301006', 'CHN125622009000601007', 'CHN126142009000201005', 'CHN126142009000601010', 'CHN125412009000601008', 'CHN125802009000101003', 'CHN125592009000601009', 'CHN125522009000601007', 'CHN125752009000301004', 'CHN125912009000201005', 'CHN126512009000201004', 'CHN125522009000201004', 'CHN125752009000201003', 'CHN125422009000201005', 'CHN126452009000201004', 'CHN125912009000301006', 'CHN126442009000101003', 'CHN125622009000101003', 'CHN125422009000601008', 'CHN125952009000201005', 'CHN125802009000201004', 'CHN125402009000201004', 'CHN126452009000601008', 'CHN126142009000101004', 'CHN125592009000101004', 'CHN125522009000301003', 'CHN126572009000101004', 'CHN125802009000601008', 'CHN126312009000201004', 'CHN125752010000601010', 'CHN125682010000201007', 'CHN126152010000301011', 'CHN125422010000201006', 'CHN125522010000301006', 'CHN125842010000201007', 'CHN125952010000301009', 'CHN126312010000301008', 'CHN126102010000201008', 'CHN125422010000301007', 'CHN125412010000201007', 'CHN126562010000301006', 'CHN126142010000201008', 'CHN125912010000101008', 'CHN125592010000301008', 'CHN125592010000201007', 'CHN126602010000201003', 'CHN125842010000601011', 'CHN125952010000601011', 'CHN126452010000601011', 'CHN125952010000101008', 'CHN126442010000601013', 'CHN125412010000601011', 'CHN126512010000601010', 'CHN126152010000101009', 'CHN125402010000201007', 'CHN125852010000601012', 'CHN125922010000201009', 'CHN125802010000101006', 'CHN125842010000101006', 'CHN126572010000201008', 'CHN125752010000201006', 'CHN125922010000601013', 'CHN126442010000101007', 'CHN125912010000301009', 'CHN126602010000301002', 'CHN125522010000201008', 'CHN126152010000601015', 'CHN126512010000301007', 'CHN125402010000301006', 'CHN125682010000101006', 'CHN125682010000601010', 'CHN126152010000201010', 'CHN126512010000201006', 'CHN126312010000201007', 'CHN125982010000601012', 'CHN125802010000301007', 'CHN126562010000201007', 'CHN126572010000101006', 'CHN126142010000301009', 'CHN125912014000101021', 'CHN125682014000601018', 'CHN125522014000101016', 'CHN125842014000601021', 'CHN126342014000201017', 'CHN126152014000201022', 'CHN125402014000101018', 'CHN125802014000601020', 'CHN125682014000201015', 'CHN126442014000201018', 'CHN126512014000301016', 'CHN126512014000601019', 'CHN125732014000301017', 'CHN126312014000301019', 'CHN126442014000101017', 'CHN125842014000301017', 'CHN125752014000101015', 'CHN125402014000201019', 'CHN126152014000601027', 'CHN125952014000201021', 'CHN126442014000601021', 'CHN125592014000201018', 'CHN126572014000601022', 'CHN126152014000301023', 'CHN125842014000201018', 'CHN126572014000201019', 'CHN126362014000201018', 'CHN126242014000101017', 'CHN126142014000101021', 'CHN126142014000201025', 'CHN125412014000301018', 'CHN125622014000601017', 'CHN125412014000201019', 'CHN125402014000301020', 'CHN125402014000601022', 'CHN125802014000201017', 'CHN125842014000101016', 'CHN125592014000301019', 'CHN125902014000301015', 'CHN125952014000601024', 'CHN125802014000101016', 'CHN126402014000301024', 'CHN125752014000301016', 'CHN125622014000201016', 'CHN126442014000301019', 'CHN126392014000601023', 'CHN125432014000201020', 'CHN125412014000601022', 'CHN126452014000301019', 'CHN125592014000101017', 'CHN126452014000601024', 'CHN125662014000301017', 'CHN125802014000301018', 'CHN126452014000201018', 'CHN125622014000101015', 'CHN125952013000301018', 'CHN125402013000601021', 'CHN125752013000101013', 'CHN125682013000601016', 'CHN126352013000301018', 'CHN126002013000301017', 'CHN125412013000101015', 'CHN126442013000101015', 'CHN126572013000201015', 'CHN125402013000101016', 'CHN125522013000201015', 'CHN125842013000101015', 'CHN126082013000601026', 'CHN126142013000201020', 'CHN126122013000301022', 'CHN125802013000101014', 'CHN126572013000601018', 'CHN126462013000101016', 'CHN125842013000201014', 'CHN126312013000201014', 'CHN126312013000301015', 'CHN125752013000301014', 'CHN126582013000201008', 'CHN125952013000101017', 'CHN126572013000301016', 'CHN126512013000101012', 'CHN126152013000601024', 'CHN125522013000301013', 'CHN125922013000601024', 'CHN126152013000301020', 'CHN126152013000201019', 'CHN126022013000101023', 'CHN125862013000301014', 'CHN126142013000301019', 'CHN125522013000601021', 'CHN125952013000601023', 'CHN126362013000201014', 'CHN125412013000301016', 'CHN126442013000201016', 'CHN126512012000201011', 'CHN125952012000601019', 'CHN125622012000201013', 'CHN125382012000601019', 'CHN125752012000101009', 'CHN125912012000101016', 'CHN126152012000601021', 'CHN125802012000201011', 'CHN125592012000101011', 'CHN125922012000101014', 'CHN125842012000201012', 'CHN125802012000601015', 'CHN125592012000201014', 'CHN126312012000101011', 'CHN125622012000101010', 'CHN125682012000601014', 'CHN125522012000301012', 'CHN125422012000101011', 'CHN125522012000101010', 'CHN125912012000601023', 'CHN125402012000101012', 'CHN125412012000101012', 'CHN125432012000301013', 'CHN125552012000201017', 'CHN126572012000201012', 'CHN126112012000601023', 'CHN125682012000301011', 'CHN125522012000201011', 'CHN126002012000301014', 'CHN125402012000601017', 'CHN125402012000301013', 'CHN125912012000201014', 'CHN125412012000301013', 'CHN126152012000201016', 'CHN126342012000601014', 'CHN125952012000101016', 'CHN126312012000601017', 'CHN126442012000301012', 'CHN125952012000301014', 'CHN126452012000201013', 'CHN126312012000201016', 'CHN125802012000301012', 'CHN125922012000201016', 'CHN125412012000601017', 'CHN125622012000601014', 'CHN125522012000601017', 'CHN126142012000301016', 'CHN126142012000201015', 'CHN125912012000301015', 'CHN125402012000201014', 'CHN126152012000301017', 'CHN126122012000601023', 'CHN125592012000301013', 'CHN125802008000201001', 'CHN125592008000601005', 'CHN125922008000601007', 'CHN125842008000301002', 'CHN126452008000301002', 'CHN125842008000201001', 'CHN125752008000601005', 'CHN126572008000201001', 'CHN125422008000301002', 'CHN126572008000601007', 'CHN126122008000301002', 'CHN126512008000601005', 'CHN125912008000601007', 'CHN126142008000601007', 'CHN126312008000601006', 'CHN125672008000601004', 'CHN125532008000301002', 'CHN125952008000301001', 'CHN125802008000601005', 'CHN125702008000601005', 'CHN125842008000601005', 'CHN125412008000601006', 'CHN126142008000301002', 'CHN126442008000601006', 'CHN126182008000601005', 'CHN125682008000201003', 'CHN125912008000301001', 'CHN125682008000301002', 'CHN125802008000301002', 'CHN126462008000601005', 'CHN125332008000201003', 'CHN125952008000601007', 'CHN125752008000301002', 'CHN125682008000601005', 'CHN125652008000601004', 'CHN125522008000301005', 'CHN125592008000201001', 'CHN126452008000201001', 'CHN125532008000201001', 'CHN125402008000201001', 'CHN126342008000601005', 'CHN126312008000201003', 'CHN126482008000301002', 'CHN126442015000601025', 'CHN125802015000301021', 'CHN126312015000201022', 'CHN126442015000201022', 'CHN125922015000101023', 'CHN125592015000201021', 'CHN125412015000101020', 'CHN125622015000201019', 'CHN126312015000601025', 'CHN126312015000301021', 'CHN125522015000301022', 'CHN126002015000201022', 'CHN125682015000201017', 'CHN125952015000101022', 'CHN125382015000201021', 'CHN126152015000601030', 'CHN126512015000201017', 'CHN125752015000101017', 'CHN125592015000601025', 'CHN126152015000101025', 'CHN125952015000301026', 'CHN125682015000601020', 'CHN126412015000101021', 'CHN126452015000601026', 'CHN126342015000601022', 'CHN125842015000301020', 'CHN125402015000301023', 'CHN125952015000601033', 'CHN125412015000201021', 'CHN126472015000601027', 'CHN125802015000201019', 'CHN126572015000101020', 'CHN126152015000301026', 'CHN125752015000201018', 'CHN125912015000101025', 'CHN125912015000301028', 'CHN125412015000601023', 'CHN126442015000101020', 'CHN125752015000601021', 'CHN125522015000101019', 'CHN126312015000101020', 'CHN126512015000601021', 'CHN125622015000101018', 'CHN125802015000601025', 'CHN125522015000601025', 'CHN126512015000301018', 'CHN125912015000601032', 'CHN125592015000301022', 'CHN125952015000201025', 'CHN125912015000201027', 'CHN125622016000601024', 'CHN126002016000601029', 'CHN126442016000301024', 'CHN126412016000601032', 'CHN125592016000101020', 'CHN126152016000301029', 'CHN126572016000101021', 'CHN125682016000601021', 'CHN126512016000301020', 'CHN125752016000301020', 'CHN125622016000101021', 'CHN125592016000301023', 'CHN126312016000201024', 'CHN125912016000101029', 'CHN125522016000101023', 'CHN125402016000301026', 'CHN126312016000101023', 'CHN126342016000601025', 'CHN126442016000601028', 'CHN126152016000101028', 'CHN126312016000601027', 'CHN125402016000601029', 'CHN125802016000101024', 'CHN126512016000601023', 'CHN125402016000201025', 'CHN125912016000601035', 'CHN125842016000601026', 'CHN125952016000301032', 'CHN125522016000201024', 'CHN126342016000201023', 'CHN125622016000201020', 'CHN125842016000201022', 'CHN125952016000101029', 'CHN125402016000101024', 'CHN125952016000301034', 'CHN125522016000601028', 'CHN125592016000601026', 'CHN126572016000201023', 'CHN126442016000101023', 'CHN125952016000201028', 'CHN125412016000101027', 'CHN125682016000201019', 'CHN125952016000601030', 'CHN125412016000201025', 'CHN126152016000601033', 'CHN125912016000301031', 'CHN125932007000601005', 'CHN126142007000601003', 'CHN126512007000601003', 'CHN125832007000601003', 'CHN125842007000601003', 'CHN125872007000601002', 'CHN125512007000601003', 'CHN126572007000601002', 'CHN125402007000601002', 'CHN126152007000601006', 'CHN126312007000601002', 'CHN125622007000601002', 'CHN125912007000601004', 'CHN125682013000301013', 'CHN126312014000201018', 'CHN125682013000101012', 'CHN125592013000101016']
    idlist = ['CHN107412009000601035']

    for l in idlist:
        reportid = l
        # print reportid
        countryid = reportid[0:3]
        companyid = reportid[0:8]
        companyname = fs_pdf_tools.getCompanyName(companyid)
        # countryid, companyid, reportid, statusid, country_name, company_name, fiscal_year,season_type_code, history_status, data_mark, doc_path, doc_type, report_type, error_code = '')
        para = Para(countryid, companyid, reportid, 20, '2', companyname, '4', '5', '6', '7', 'x', '8', '9')

        process(para)

    # 一系列数据状态更新
    # update_aft_push()